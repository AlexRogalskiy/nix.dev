name: "CI"
on: 
- pull_request
- push

jobs:
  docs:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2.3.4
    - uses: actions/setup-python@v2
      with:
        python-version: 3.8
    - uses: abatilo/actions-poetry@v2.0.0
    - name: Export requirements.txt
      run: poetry export -f requirements.txt --output requirements.txt
    - uses: ammaraskar/sphinx-action@0.4
      with:
        docs-folder: "."
        build-command: make html linkcheck
  nix:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2.3.4
    - uses: cachix/install-nix-action@v13
      with:
        nix_path: nixpkgs=channel:nixos-unstable
    - run: nix-build
